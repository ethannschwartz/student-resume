import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"vue-bundle-renderer/runtime";import{b as o,a as s,c as a,d as i,e as d,u,g as l,f as c,h as p,i as h,p as f,j as m,k as y,l as g,m as b,n as _,o as w,q as v,r as x}from"../../index.mjs";import{renderToString as j}from"vue/server-renderer";import{createHead as C,propsToString as S,renderSSRHead as T}from"unhead/server";import{stringify as A,uneval as R}from"devalue";import{FlatMetaPlugin as $}from"unhead/plugins";import{walkResolver as H}from"unhead/utils";import{toValue as k,isRef as P,hasInjectionContext as M,inject as L,ref as U,watchEffect as z,getCurrentInstance as O,onBeforeUnmount as N,onDeactivated as F,onActivated as E}from"vue";const VueResolver=(e,t)=>P(t)?k(t):t,q="usehead";function injectHead(){if(M()){const e=L(q);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}function useHead(e,t={}){const r=t.head||injectHead();return r.ssr?r.push(e||{},t):function(e,t,r={}){const n=U(!1);let o;z(()=>{const s=n.value?{}:H(t,VueResolver);o?o.patch(s):o=e.push(s,r)});O()&&(N(()=>{o.dispose()}),F(()=>{n.value=!0}),E(()=>{n.value=!1}));return o}(r,e,t)}function useSeoMeta(e={},t={}){(t.head||injectHead()).use($);const{title:r,titleTemplate:n,...o}=e;return useHead({title:r,titleTemplate:n,_flatMeta:o},t)}function createHead(e={}){const t=C({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(q,e)}}.install}(t),t}const D=`<${s}${S(a)}>`,I=`</${s}>`,getPrecomputedDependencies=()=>import("../build/client.precomputed.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),X=lazyCachedFunction(async()=>{const t=await import("../build/server.mjs").then(e=>e.default||e);if(!t)throw new Error("Server bundle is not available");const r=await getPrecomputedDependencies();return e(t,{precomputed:r,manifest:void 0,renderToString:async function(e,t){const r=await j(e,t);return D+r+I},buildAssetsURL:o})}),J=lazyCachedFunction(async()=>{const t=await getPrecomputedDependencies(),r=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>{{const t=`<${i}${S(d)}>`;return D+I+(e?t+e+`</${i}>`:"")}}),n=e(()=>()=>{},{precomputed:t,manifest:void 0,renderToString:()=>r,buildAssetsURL:o}),s=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=u(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(s)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}const B=lazyCachedFunction(()=>import("../build/styles.mjs").then(e=>e.default||e));function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?A(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":p,"data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${R(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...n}=e.payload;return{initial:{...n,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}const W={disableDefaults:!0};const Y={omitLineBreaks:!0},G=[];globalThis.__buildAssetsURL=o,globalThis.__publicAssetsURL=f;const K=!!y.id,Q=K?`<${m}${S(y)}>`:"",V=K?`</${m}>`:"",Z=/^[^?]*\/_payload.json(?:\?.*)?$/,ee=h(async e=>{const s=x(),a=e.path.startsWith("/__nuxt_error")?g(e):null;if(a&&!("__unenv__"in e.node.req))throw b({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const i=function(e){return{url:e.path,event:e,runtimeConfig:u(e),noSSR:e.context.nuxt?.noSSR||!1,head:createHead(W),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set}}(e),d={mode:"server"};if(i.head.push(_,d),a){if(a.statusCode&&=Number.parseInt(a.statusCode),"string"==typeof a.data)try{a.data=w(a.data)}catch{}!function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(i,a)}const p=Z.test(i.url);if(p){const t=i.url.substring(0,i.url.lastIndexOf("/"))||"/";i.url=t,e._path=e.node.req.url=t}const h=v(e);!1===h.ssr&&(i.noSSR=!0);const f=await function(e){return e.noSSR?J():X()}(i);for(const e of G)i.modules.add(e);const m=await f.renderToString(i).catch(async e=>{if(i._renderResponse&&"skipping render"===e.message)return{};const t=!a&&i.payload?.error||e;throw await(i.nuxt?.hooks.callHook("app:error",t)),t}),j=i._renderResponse||p?[]:await async function(e){const t=await B(),r=new Set;for(const n of e)if(n in t&&t[n])for(const e of await t[n]())r.add(e);return Array.from(r).map(e=>({innerHTML:e}))}(i.modules??[]);if(await(i.nuxt?.hooks.callHook("app:rendered",{ssrContext:i,renderResult:m})),i._renderResponse)return i._renderResponse;if(i.payload?.error&&!a)throw i.payload.error;if(p){const e=function(e){return{body:A(splitPayload(e).payload,e._payloadReducers),statusCode:c(e.event),statusMessage:l(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(i);return e}const C=h.noScripts,{styles:S,scripts:R}=t(i,f.rendererContext);i._preloadManifest&&!C&&i.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:o(`builds/meta/${i.runtimeConfig.app.buildId}.json`)}]},{...d,tagPriority:"low"}),j.length&&i.head.push({style:j});const $=[];for(const e of Object.values(S))$.push({rel:"stylesheet",href:f.rendererContext.buildAssetsURL(e.file),crossorigin:""});if($.length&&i.head.push({link:$},d),C||(i.head.push({link:r(i,f.rendererContext)},d),i.head.push({link:n(i,f.rendererContext)},d),i.head.push({script:renderPayloadJsonScript({ssrContext:i,data:i.payload})},{...d,tagPosition:"bodyClose",tagPriority:"high"})),!h.noScripts){const e="head";i.head.push({script:Object.values(R).map(t=>({type:t.module?"module":null,src:f.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},d)}const{headTags:H,bodyTags:k,bodyTagsOpen:P,htmlAttrs:M,bodyAttrs:L}=await T(i.head,Y),U={htmlAttrs:M?[M]:[],head:normalizeChunks([H]),bodyAttrs:L?[L]:[],bodyPrepend:normalizeChunks([P,i.teleports?.body]),body:[m.html,Q+(K?joinTags([i.teleports?.[`#${y.id}`]]):"")+V],bodyAppend:[k]};return await s.hooks.callHook("render:html",U,{event:e}),{body:(z=U,`<!DOCTYPE html><html${joinAttrs(z.htmlAttrs)}><head>${joinTags(z.head)}</head><body${joinAttrs(z.bodyAttrs)}>${joinTags(z.bodyPrepend)}${joinTags(z.body)}${joinTags(z.bodyAppend)}</body></html>`),statusCode:c(e),statusMessage:l(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var z});function normalizeChunks(e){const t=[];for(const r of e){const e=r?.trim();e&&t.push(e)}return t}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const te=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{useSeoMeta as a,q as h,te as r,useHead as u};
//# sourceMappingURL=renderer.mjs.map
